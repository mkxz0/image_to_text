â€<!DOCTYPE html>
â€<html lang="ar">
â€<head>
â€  <meta charset="UTF-8">
â€  <title>ğŸ¬ Ø£Ø¯Ø§Ø© TikTok - Ø¹Ø±Ø¶ ÙˆØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª</title>
â€  <style>
â€    body {
â€      font-family: Arial, sans-serif;
â€      direction: rtl;
â€      background: #f0f0f0;
â€      margin: 0;
â€      padding: 30px;
â€      text-align: center;
    }
â€    input, button {
â€      width: 90%;
â€      max-width: 400px;
â€      padding: 12px;
â€      margin: 10px 0;
â€      font-size: 16px;
â€      border-radius: 6px;
â€      border: 1px solid #ccc;
    }
â€    button {
â€      background: #007bff;
â€      color: white;
â€      cursor: pointer;
â€      border: none;
    }
â€    button:hover {
â€      background: #0056b3;
    }
â€    #status {
â€      margin: 20px 0;
â€      font-weight: bold;
â€      color: #d00;
    }
â€    #videoContainer blockquote {
â€      margin: auto;
â€      max-width: 600px;
â€      min-width: 325px;
    }
â€    #downloadLink {
â€      display: none;
â€      margin-top: 15px;
    }
â€  </style>
â€</head>
â€<body>
â€  <h2>ğŸ“² Ø¹Ø±Ø¶ ÙˆØªØ­Ù…ÙŠÙ„ ÙÙŠØ¯ÙŠÙˆ TikTok</h2>

â€  <input type="text" id="tiktokInput" placeholder="Ø£Ù„ØµÙ‚ Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ TikTok (Ø­ØªÙ‰ Ù„Ùˆ Ù…Ø®ØªØµØ±)">
â€  <br>
â€  <button onclick="handleInput()">Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</button>

â€  <div id="status"></div>
â€  <div id="videoContainer"></div>
â€  <a id="downloadLink" href="#" target="_blank" download>â¬‡ï¸ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</a>

â€  <script>
â€    const UNSHORTEN_TOKEN = ' 7c0745c8698b3822502387854f32aa5dd8926306'; // ØªÙˆÙƒÙ† API

â€    async function unshortenLink(url) {
â€      const apiUrl = 'https://unshorten.me/api/v2/unshorten?url=' + encodeURIComponent(url);
â€      const res = await fetch(apiUrl, {
â€        method: 'GET',
â€        headers: {
â€          'Authorization': 'Token ' + UNSHORTEN_TOKEN
        }
      });
â€      if (!res.ok) throw new Error('ÙÙƒ Ø§Ù„Ø±Ø§Ø¨Ø· ÙØ´Ù„: ' + res.status);
â€      const data = await res.json();
â€      return data.success ? data["unshortened_url"] : null;
    }

â€    function extractVideoId(url) {
â€      const match = url.match(/video\/(\d{10,25})/);
â€      return match ? match[1] : null;
    }

â€    function getDownloadUrl(tiktokUrl) {
â€      return `https://ssstik.io/api/convert?url=${encodeURIComponent(tiktokUrl)}`;
    }

â€    async function handleInput() {
â€      const input = document.getElementById('tiktokInput').value.trim();
â€      const status = document.getElementById('status');
â€      const container = document.getElementById('videoContainer');
â€      const downloadLink = document.getElementById('downloadLink');

â€      status.textContent = 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©â€¦';
â€      status.style.color = '#000';
â€      container.innerHTML = '';
â€      downloadLink.style.display = 'none';
â€      downloadLink.href = '#';

â€      if (!input) {
â€        status.textContent = 'âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· TikTok.';
â€        status.style.color = 'red';
â€        return;
      }

â€      let fullUrl = input;
â€      try {
â€        if (input.includes('vt.tiktok.com') || input.includes('bit.ly') || input.includes('tinyurl.com')) {
â€          fullUrl = await unshortenLink(input);
â€          if (!fullUrl) throw new Error('ÙØ´Ù„ ÙÙƒ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø®ØªØµØ±.');
        }

        // Ù…Ù†Ø¹ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„ØµÙˆØ± Ø£Ùˆ Ø§Ù„Ù€ slideshow
â€        if (fullUrl.includes('/photo/') || fullUrl.includes('carousel')) {
â€          status.textContent = 'âš ï¸ Ù‡Ø°Ø§ Ø§Ù„Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª (ØµÙˆØ± ÙÙ‚Ø·) Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ¶Ù…ÙŠÙ†Ù‡.';
â€          status.style.color = 'orange';
â€          return;
        }

â€        const id = extractVideoId(fullUrl);
â€        if (!id) throw new Error('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ø§Ø¨Ø· ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ video/ID.');

        // ØªØ¶Ù…ÙŠÙ† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
â€        const block = document.createElement('blockquote');
â€        block.className = 'tiktok-embed';
â€        block.setAttribute('cite', fullUrl);
â€        block.setAttribute('data-video-id', id);
â€        block.innerHTML = '<section>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ...</section>';
â€        container.appendChild(block);

â€        const oldScript = document.querySelector('#tiktok-script');
â€        if (oldScript) oldScript.remove();

â€        const script = document.createElement('script');
â€        script.src = 'https://www.tiktok.com/embed.js';
â€        script.async = true;
â€        script.id = 'tiktok-script';
â€        document.body.appendChild(script);

        // Ø±Ø§Ø¨Ø· ØªØ­Ù…ÙŠÙ„ ØªØ¬Ø±ÙŠØ¨ÙŠ (ØºÙŠØ± Ø±Ø³Ù…ÙŠØŒ ÙˆÙ‚Ø¯ Ù„Ø§ ÙŠØ¹Ù…Ù„ Ù…Ø¹ ÙƒÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª)
â€        const ssstikUrl = `https://ssstik.io/en?url=${encodeURIComponent(fullUrl)}`;
â€        downloadLink.href = ssstikUrl;
â€        downloadLink.style.display = 'inline-block';

â€        status.textContent = 'âœ… Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¸Ø§Ù‡Ø± ÙˆÙŠÙ…ÙƒÙ† ØªØ­Ù…ÙŠÙ„Ù‡ Ø£Ø¯Ù†Ø§Ù‡ ğŸ‘‡';
â€        status.style.color = 'green';

â€      } catch (err) {
â€        status.textContent = 'âŒ ' + err.message;
â€        status.style.color = 'red';
      }
    }
â€  </script>
â€</body>
â€</html>
